{
  "$id": "https://github.com/g5search/messages/blob/master/analytics/websites/v1/websites.schema.json",
  "type": "object",
  "description": "Website events",
  "required": [
    "deploy_id",
    "event",
    "domain",
    "owner_urn"
  ],
  "properties": {
    "event": {
      "type": "string",
      "enum": [
        "repo-push-begin",
        "repo-push-success",
        "gcs-copy-begin",
        "gcs-copy-success",
        "error"
      ],
      "description": "We are reusing a 'websites' topic and the messages are differentiated by 'event'"
    },
    "deploy_id": {
      "type": "string",
      "description": "An ID that events can be grouped on"
    },
    "deploy_timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Used to know if messages after repo-push-begin are out of order"
    },
    "domain": {
      "type": "string",
      "description": "The website domain"
    },
    "website_urn": {
      "type": "string",
      "description": "The website URN"
    },
    "cms_urn": {
      "type": "string",
      "description": "When multi-domain, it's the website_urn. When single-domain, it's the client.website.urn"
    },
    "website_name": {
      "type": "string",
      "description": "The website name"
    },
    "owner_urn": {
      "type": "string",
      "description": "The website's owner URN. It's either a client_urn or location_urn"
    },
    "location_urn": {
      "type": "string"
    },
    "client_urn": {
      "type": "string"
    },
    "repo_uri": {
      "type": "string",
      "description": "URI to the git repo"
    },
    "gcs_uri": {
      "type": "string",
      "description": "URI to google cloud storage"
    },
    "cms_repo_dir": {
      "type": "string",
      "description": "The location of the CMS repo-dir. This directory automatically gets deleted by a nightly job. Present in steps after repo-push-begin"
    },
    "gcs_cp_command": {
      "type": "string",
      "description": "The Google Cloud Storage command executed to copy the contents of 'cms_repo_dir' to GCS. Present in steps after repo-push-success"
    },
    "error_message": {
      "type": "string",
      "description": "Description of error, Present when error"
    },
    "error_on_step": {
      "type": "string",
      "description": "where the error occurred. Present when error"
    }
  }
}